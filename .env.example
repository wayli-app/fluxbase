# Fluxbase Environment Variables
# Copy this file to .env for local development

# Server Configuration
FLUXBASE_SERVER_ADDRESS=:8080
FLUXBASE_SERVER_READ_TIMEOUT=15s
FLUXBASE_SERVER_WRITE_TIMEOUT=15s
FLUXBASE_SERVER_IDLE_TIMEOUT=60s
FLUXBASE_SERVER_BODY_LIMIT=2147483648  # 2GB in bytes (default). Max size for HTTP request bodies including file uploads

# Database Configuration
FLUXBASE_DATABASE_HOST=localhost
FLUXBASE_DATABASE_PORT=5432
FLUXBASE_DATABASE_USER=postgres                      # Runtime user for normal operations
FLUXBASE_DATABASE_PASSWORD=postgres                  # Password for runtime user
# Admin user for migrations (if not set, uses FLUXBASE_DATABASE_USER)
FLUXBASE_DATABASE_ADMIN_USER=postgres
FLUXBASE_DATABASE_ADMIN_PASSWORD=postgres
FLUXBASE_DATABASE_DATABASE=fluxbase
FLUXBASE_DATABASE_SSL_MODE=disable
FLUXBASE_DATABASE_MAX_CONNECTIONS=25
FLUXBASE_DATABASE_MIN_CONNECTIONS=5
FLUXBASE_DATABASE_MAX_CONN_LIFETIME=1h
FLUXBASE_DATABASE_MAX_CONN_IDLE_TIME=30m
FLUXBASE_DATABASE_HEALTH_CHECK_PERIOD=1m

# Authentication Configuration
FLUXBASE_AUTH_JWT_SECRET=your-secret-key-change-in-production
FLUXBASE_AUTH_JWT_EXPIRY=15m
FLUXBASE_AUTH_REFRESH_EXPIRY=168h  # 7 days (Go duration: use h for hours, m for minutes, s for seconds)
FLUXBASE_AUTH_PASSWORD_MIN_LENGTH=8
FLUXBASE_AUTH_BCRYPT_COST=10
FLUXBASE_AUTH_ENABLE_SIGNUP=true
FLUXBASE_AUTH_ENABLE_MAGIC_LINK=true

# Security Configuration
# REQUIRED: Admin Setup Token - Dashboard is disabled if not set
# Generate a secure token: openssl rand -base64 32
FLUXBASE_SECURITY_SETUP_TOKEN=your-secret-setup-token-change-in-production

# Storage Configuration
FLUXBASE_STORAGE_PROVIDER=local  # Options: local, s3
FLUXBASE_STORAGE_LOCAL_PATH=./storage
FLUXBASE_STORAGE_MAX_UPLOAD_SIZE=2147483648  # 2GB in bytes (default). Max individual file size for storage uploads

# S3 Storage Configuration (if provider is s3)
# FLUXBASE_STORAGE_S3_ENDPOINT=
# FLUXBASE_STORAGE_S3_ACCESS_KEY=
# FLUXBASE_STORAGE_S3_SECRET_KEY=
# FLUXBASE_STORAGE_S3_BUCKET=
# FLUXBASE_STORAGE_S3_REGION=us-east-1
# FLUXBASE_STORAGE_S3_FORCE_PATH_STYLE=true  # Use path-style addressing (required for MinIO, R2, Spaces, etc.)
# FLUXBASE_STORAGE_DEFAULT_BUCKETS=uploads,temp-files,public  # Buckets to auto-create on startup

# Realtime/WebSocket Configuration
FLUXBASE_REALTIME_ENABLED=true
FLUXBASE_REALTIME_MAX_CONNECTIONS=1000
FLUXBASE_REALTIME_PING_INTERVAL=30s
FLUXBASE_REALTIME_PONG_TIMEOUT=60s
FLUXBASE_REALTIME_WRITE_BUFFER_SIZE=1024
FLUXBASE_REALTIME_READ_BUFFER_SIZE=1024
FLUXBASE_REALTIME_MESSAGE_SIZE_LIMIT=524288  # 512KB in bytes
FLUXBASE_REALTIME_CHANNEL_BUFFER_SIZE=100

# Base URL (used for magic links, OAuth redirects, etc.)
FLUXBASE_BASE_URL=http://localhost:8080

# Debug Mode
FLUXBASE_DEBUG=false

# Email Configuration (for magic links, verification emails, etc.)
FLUXBASE_EMAIL_ENABLED=false
FLUXBASE_EMAIL_PROVIDER=smtp  # Options: smtp, sendgrid, mailgun, ses
FLUXBASE_EMAIL_FROM_ADDRESS=noreply@fluxbase.eu
FLUXBASE_EMAIL_FROM_NAME=Fluxbase
FLUXBASE_EMAIL_REPLY_TO_ADDRESS=support@fluxbase.eu
FLUXBASE_EMAIL_MAGIC_LINK_EXPIRY=15m

# SMTP Configuration (if provider is smtp)
# For local development with MailHog (docker-compose), use:
#   FLUXBASE_EMAIL_SMTP_HOST=mailhog
#   FLUXBASE_EMAIL_SMTP_PORT=1025
#   FLUXBASE_EMAIL_SMTP_TLS=false
# For production, use your actual SMTP provider:
FLUXBASE_EMAIL_SMTP_HOST=smtp.gmail.com
FLUXBASE_EMAIL_SMTP_PORT=587
FLUXBASE_EMAIL_SMTP_USERNAME=
FLUXBASE_EMAIL_SMTP_PASSWORD=
FLUXBASE_EMAIL_SMTP_TLS=true  # true for STARTTLS (port 587), false for no encryption

# SendGrid Configuration (if provider is sendgrid)
# FLUXBASE_EMAIL_SENDGRID_API_KEY=your-sendgrid-api-key

# Mailgun Configuration (if provider is mailgun)
# FLUXBASE_EMAIL_MAILGUN_API_KEY=your-mailgun-api-key
# FLUXBASE_EMAIL_MAILGUN_DOMAIN=your-domain.com

# AWS SES Configuration (if provider is ses)
# FLUXBASE_EMAIL_SES_ACCESS_KEY=your-aws-access-key
# FLUXBASE_EMAIL_SES_SECRET_KEY=your-aws-secret-key
# FLUXBASE_EMAIL_SES_REGION=us-east-1

# Email Templates (optional - uses defaults if not provided)
# FLUXBASE_EMAIL_MAGIC_LINK_TEMPLATE=path/to/magic-link-template.html
# FLUXBASE_EMAIL_VERIFICATION_TEMPLATE=path/to/verification-template.html

# Redis Configuration (for caching and session storage)
FLUXBASE_REDIS_ENABLED=false
FLUXBASE_REDIS_HOST=localhost
FLUXBASE_REDIS_PORT=6379
FLUXBASE_REDIS_PASSWORD=
FLUXBASE_REDIS_DB=0
FLUXBASE_REDIS_MAX_RETRIES=3
FLUXBASE_REDIS_POOL_SIZE=10

# Metrics and Monitoring
FLUXBASE_METRICS_ENABLED=false
FLUXBASE_METRICS_PORT=9090
FLUXBASE_METRICS_PATH=/metrics

# OpenTelemetry Tracing Configuration
# Traces are exported via OTLP gRPC to any compatible collector (Jaeger, Grafana Tempo, etc.)
FLUXBASE_TRACING_ENABLED=false
FLUXBASE_TRACING_ENDPOINT=localhost:4317         # OTLP gRPC endpoint (e.g., Jaeger collector, Grafana Agent)
FLUXBASE_TRACING_SERVICE_NAME=fluxbase           # Service name for traces
FLUXBASE_TRACING_ENVIRONMENT=development         # Environment: development, staging, production
FLUXBASE_TRACING_SAMPLE_RATE=1.0                 # Sample rate: 0.0-1.0 (1.0 = 100% of traces)
FLUXBASE_TRACING_INSECURE=true                   # Use insecure connection (for local dev)

# Rate Limiting
FLUXBASE_RATE_LIMIT_ENABLED=false
FLUXBASE_RATE_LIMIT_REQUESTS_PER_SECOND=100
FLUXBASE_RATE_LIMIT_BURST=200

# CORS Configuration
FLUXBASE_CORS_ALLOWED_ORIGINS=*
FLUXBASE_CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
FLUXBASE_CORS_ALLOWED_HEADERS=Origin,Content-Type,Accept,Authorization,X-Request-ID,X-CSRF-Token,Prefer,apikey,X-Requested-With,x-client-app
FLUXBASE_CORS_EXPOSED_HEADERS=Content-Range,Content-Encoding,Content-Length,X-Request-ID,X-RateLimit-Limit,X-RateLimit-Remaining,X-RateLimit-Reset
FLUXBASE_CORS_ALLOW_CREDENTIALS=true
FLUXBASE_CORS_MAX_AGE=300

# API Keys and External Services
# FLUXBASE_API_KEYS=key1,key2,key3  # Comma-separated list of API keys
# FLUXBASE_STRIPE_SECRET_KEY=
# FLUXBASE_STRIPE_WEBHOOK_SECRET=
# FLUXBASE_GOOGLE_CLIENT_ID=
# FLUXBASE_GOOGLE_CLIENT_SECRET=
# FLUXBASE_GITHUB_CLIENT_ID=
# FLUXBASE_GITHUB_CLIENT_SECRET=

# Feature Flags
FLUXBASE_FEATURES_AUTH_ENABLED=true
FLUXBASE_FEATURES_STORAGE_ENABLED=true
FLUXBASE_FEATURES_REALTIME_ENABLED=true
FLUXBASE_FEATURES_FUNCTIONS_ENABLED=true
FLUXBASE_FEATURES_JOBS_ENABLED=true
FLUXBASE_FEATURES_ADMIN_UI_ENABLED=false

# Admin Configuration
FLUXBASE_ADMIN_EMAIL=admin@fluxbase.eu
FLUXBASE_ADMIN_PASSWORD=changeme

# Jobs Configuration (Background Job Processing)
# Note: Jobs are enabled by default. Use FLUXBASE_FEATURES_JOBS_ENABLED=false to disable.
FLUXBASE_JOBS_DIR=./jobs                       # Directory containing job functions
FLUXBASE_JOBS_AUTO_LOAD_ON_BOOT=true           # Auto-load jobs from directory on startup (default: true)
FLUXBASE_JOBS_EMBEDDED_WORKER_COUNT=4          # Number of worker threads (default: 4, set to 0 to disable workers)
FLUXBASE_JOBS_DEFAULT_MAX_DURATION=300s        # Default job timeout (default: 5m)
FLUXBASE_JOBS_MAX_MAX_DURATION=3600s           # Maximum allowed job timeout (default: 1h)
FLUXBASE_JOBS_DEFAULT_PROGRESS_TIMEOUT=300s    # Progress reporting timeout (default: 5m)
FLUXBASE_JOBS_POLL_INTERVAL=1s                 # Worker poll interval (default: 1s)
FLUXBASE_JOBS_WORKER_HEARTBEAT_INTERVAL=10s    # Worker heartbeat interval (default: 10s)

# Execution Logs Retention (used by cleanup-execution-logs builtin job)
# The builtin job is disabled by default - enable it via the admin API to activate cleanup
# Set to 0 to skip cleanup for that specific log type
# FLUXBASE_JOBS_FUNCTIONS_LOGS_RETENTION_DAYS=30   # Functions execution logs retention (default: 30 days)
# FLUXBASE_JOBS_RPC_LOGS_RETENTION_DAYS=30         # RPC execution logs retention (default: 30 days)
# FLUXBASE_JOBS_JOBS_LOGS_RETENTION_DAYS=30        # Jobs execution logs retention (default: 30 days)

# AI Configuration
# Note: AI chatbots are enabled by default via FLUXBASE_FEATURES_AI_ENABLED=true
# Chatbot definitions are loaded from the chatbots directory (default: ./chatbots)
FLUXBASE_AI_CHATBOTS_DIR=./chatbots
FLUXBASE_AI_AUTO_LOAD_ON_BOOT=true
FLUXBASE_AI_DEFAULT_MAX_TOKENS=4096
FLUXBASE_AI_QUERY_TIMEOUT=30s
FLUXBASE_AI_MAX_ROWS_PER_QUERY=1000
FLUXBASE_AI_CONVERSATION_CACHE_TTL=1h
FLUXBASE_AI_MAX_CONVERSATION_TURNS=50

# AI Provider Configuration (Optional - defaults to database-configured providers)
# When configured via environment, the provider becomes read-only in the dashboard
# and takes precedence over database providers
FLUXBASE_AI_PROVIDER_ENABLED=false              # Enable config-based provider
FLUXBASE_AI_PROVIDER_TYPE=openai                # Provider type: openai, azure, ollama
FLUXBASE_AI_PROVIDER_NAME=Default Provider      # Display name for the provider
FLUXBASE_AI_PROVIDER_MODEL=gpt-4-turbo          # Default model to use

# OpenAI Provider Settings (when FLUXBASE_AI_PROVIDER_TYPE=openai)
FLUXBASE_AI_OPENAI_API_KEY=                     # OpenAI API key (required for OpenAI)
# FLUXBASE_AI_OPENAI_ORGANIZATION_ID=           # Optional: OpenAI organization ID
# FLUXBASE_AI_OPENAI_BASE_URL=                  # Optional: Custom base URL for OpenAI-compatible APIs

# Azure OpenAI Provider Settings (when FLUXBASE_AI_PROVIDER_TYPE=azure)
# FLUXBASE_AI_AZURE_API_KEY=                    # Azure OpenAI API key
# FLUXBASE_AI_AZURE_ENDPOINT=                   # Azure OpenAI endpoint (e.g., https://your-resource.openai.azure.com)
# FLUXBASE_AI_AZURE_DEPLOYMENT_NAME=            # Azure deployment name
# FLUXBASE_AI_AZURE_API_VERSION=2024-02-15-preview  # Azure API version (default: 2024-02-15-preview)

# Ollama Provider Settings (when FLUXBASE_AI_PROVIDER_TYPE=ollama)
# FLUXBASE_AI_OLLAMA_ENDPOINT=http://localhost:11434  # Ollama endpoint (default: http://localhost:11434)
# FLUXBASE_AI_OLLAMA_MODEL=llama2                     # Ollama model name (required for Ollama)

# RPC Configuration (Remote Procedure Calls)
# Note: RPC is enabled by default. Procedures are defined in SQL files with @fluxbase annotations.
FLUXBASE_RPC_ENABLED=true
FLUXBASE_RPC_PROCEDURES_DIR=./rpc                    # Directory containing RPC procedure files
FLUXBASE_RPC_AUTO_LOAD_ON_BOOT=true                  # Auto-load procedures from directory on startup
FLUXBASE_RPC_DEFAULT_MAX_EXECUTION_TIME=30s          # Default procedure execution timeout
FLUXBASE_RPC_MAX_MAX_EXECUTION_TIME=5m               # Maximum allowed execution timeout
FLUXBASE_RPC_DEFAULT_MAX_ROWS=1000                   # Default max rows returned per query

# Deployment Environment
FLUXBASE_ENVIRONMENT=development  # Options: development, staging, production
FLUXBASE_VERSION=development
FLUXBASE_COMMIT_SHA=development
